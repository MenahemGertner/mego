<canvas id= "myCanvas" width="1250" height="650" style="border: 1px solid;"></canvas>

<script>

function Man_Moves(){

    if (event.keyCode == 39 && interceptor_x < 1180){
        interceptor_x += 20;
        for(var k=0; k<missiles.length ; k++){
            if(missiles[k].y == interceptor_y)
                missiles[k].x += 20; }
        }

    if (event.keyCode == 37 && interceptor_x > 0){
        interceptor_x -= 20;
        for(var k=0; k<missiles.length ; k++){
            if(missiles[k].y == interceptor_y)
                missiles[k].x -= 20; }
        }
  
    if (event.keyCode == 32){
        if (missiles.some(missile => missile.y == interceptor_y)){
            missiles.filter(missile => missile.y == interceptor_y)[0].y -= 1;
    }}
    // if (event.keyCode == 40) 
    // t = 1;
    // if (event.keyCode == 38) 
    // t = 0;

    // if (event.keyCode == 13) {
    //         pause = false;             
    //     }

}


function Rocket_Direction(rocket_x, rocket_y) {
// var a = 1; b = 1; c = 150;
if (rocket_y > 100){
//     rocket_x += a;
//     rocket_y -= b; 
//     if (rocket_x == c +25){
//         if (rocket_x < 300){
//         a += 0.2;
//         b -= 0.2;
//         c = rocket_x;}
//     else if (rocket_x < 600){
//         a -= 0.2;
//         b += 0.2;
//         c = rocket_x;}
//     }}
    if (rocket_x < 175){
        rocket_x += 1;
        rocket_y -= 1;}
    else if (rocket_x < 200){
        rocket_x += 1.2;
        rocket_y -= 0.8;}
    else if (rocket_x < 225){
        rocket_x += 1.4;
        rocket_y -= 0.6;}
    else if (rocket_x < 250){
        rocket_x += 1.6;
        rocket_y -= 0.4;}
    else if (rocket_x < 275){
        rocket_x += 1.8;
        rocket_y -= 0.2;}
    else if (rocket_x < 300){
        rocket_x += 2;}
    else if (rocket_x < 600){
        rocket_x += 1.8;
        rocket_y += 0.2;}
    else if (rocket_x < 625){
        rocket_x += 1.6;
        rocket_y += 0.4;}
    else if (rocket_x < 650){
        rocket_x += 1.4;
        rocket_y += 0.6;}
    else if (rocket_x < 725){
        rocket_x += 1.2;
        rocket_y += 0.8;}
    else {
        rocket_x += 1;
        rocket_y += 1.1;}}
else{
    if (rocket_x < 200){
        rocket_x += 1.6;
        rocket_y -= 0.4;}
    else if (rocket_x < 225){
        rocket_x += 1.8;
        rocket_y -= 0.2;}
    else if (rocket_x < 250){
        rocket_x += 2;}
    else if (rocket_x < 350){
        rocket_x += 1.8;
        rocket_y += 0.2;}
    else if (rocket_x < 375){
        rocket_x += 1.6;
        rocket_y += 0.4;}
    else if (rocket_x < 400){
        rocket_x += 1.4;
        rocket_y += 0.6;}
    else if (rocket_x < 425){
        rocket_x += 1.2;
        rocket_y += 0.8;}
    else {
        rocket_x += 1;
        rocket_y += 1.1;}
}
return [rocket_x, rocket_y];
}
function Rocket_Aviation(){
    ctx.drawImage(img_reka, 0, 0, 1250, 650);  
     
    ctx.font = "30px Arial";
    ctx.fillStyle = "green";
    if (money < 500)
        ctx.fillStyle = "red";
    ctx.fillText("money: " + money + "$", 1020, 50);  
    ctx.fillStyle = "gold";
    ctx.fillText("level: " + level , 1020, 100);
    for(var k=0; k<missiles.length ; k++){
        ctx.drawImage(img_kb_rocket, missiles[k].x, missiles[k].y, 40, 40);
        if (missiles[k].y != interceptor_y){
            missiles[k].x -= 1;
            missiles[k].y -= 2;
            if(missiles[k].y < -40){
                missiles[k].x = interceptor_x + 15; missiles[k].y = interceptor_y;
                money -= 100;
}}}
    ctx.drawImage(img_kipat_barzel, interceptor_x, interceptor_y, 80, 80);

    for(var i=0, j=650 ; i<rockets.length ; i++){
        if (j<1300)
            j += 200;
        else
            j = 650;
        ctx.drawImage(img_rocket, rockets[i].x, rockets[i].y, 13, 13);
        [rockets[i].x, rockets[i].y] = Rocket_Direction(rockets[i].x, rockets[i].y);
        if (rockets[i].y > j){
            rockets[i].x = 0;
            rockets[i].y = Math.floor(Math.random()* 649);}

        if (rockets[i].x > interceptor_x && rockets[i].x < interceptor_x +40 &&
            rockets[i].y > interceptor_y && rockets[i].y < 650){
            audio_boom.play();
            alert('Game over!\nYour interceptor has been hit!');
            money = 1000;
            level = 0;
            add_rocket = 0;
            rockets = new Array({x: 1300, y: 650});
            missiles = new Array({x: interceptor_x + 15, y: interceptor_y}, {x: interceptor_x + 15, y: interceptor_y},
                             {x: interceptor_x + 15, y: interceptor_y}, {x: interceptor_x + 15, y: interceptor_y})
            play_again = confirm('Do you want play again?');
            if (play_again == false)
                window.close();
                rockets[i].x = 0; rockets[i].y = Math.floor(Math.random()* 649);

        }
        if (rockets[i].y > 649 && rockets[i].y < 650)
            money -= 100;

        for(var k=0; k<missiles.length ; k++){
            if (rockets[i].x > missiles[k].x +5 && rockets[i].x < missiles[k].x +35 &&
                rockets[i].y > missiles[k].y && rockets[i].y < missiles[k].y +40){
                if (missiles[k].y != interceptor_y){
                    audio_boom.play();           
                    rockets[i].x = 0; rockets[i].y = Math.floor(Math.random()* 649);
                    ctx.drawImage(img_rocket, missiles[k].x, missiles[k].y, 80, 80);
                    missiles[k].x = interceptor_x + 15; missiles[k].y = interceptor_y;
                    money += 100;
        }}}
        }
        
if (money >= add_rocket + 400){
    audio_succes.play();
    rockets.push({x: 1300, y: 650});
    add_rocket = money;
    level += 1;
}
if (money <= 0) {
    alert('Game over!\nYour money is gone!');
    money = 1000;
    level = 0;
    add_rocket = 0;   
    rockets = new Array({x: 1300, y: 650});
    missiles = new Array({x: interceptor_x + 15, y: interceptor_y}, {x: interceptor_x + 15, y: interceptor_y},
                             {x: interceptor_x + 15, y: interceptor_y}, {x: interceptor_x + 15, y: interceptor_y})
    play_again = confirm('Do you want play again?');
    if (play_again == false)
        window.close(); 
}
  

// if (pause == false)
// throw new Error('Program paused');
// else
// runProgram(); 
//if (t == 1){
    // ctx.clearRect(interceptor_x, interceptor_y, 80, 80);
    // ctx.save();
    // ctx.translate(interceptor_x + 40, interceptor_y + 40);
    // ctx.rotate(-Math.PI / 4);
    // ctx.drawImage(img_kipat_barzel, -40, -40, 80, 80);
    // ctx.restore();

// }

img_rocket.src = "rocket.png";
img_reka.src = "reka.jpeg";
img_kipat_barzel.src = "kipat_barzel.png";
img_kb_rocket.src = "kb_rocket.png";
}

    var ctx = document.getElementById('myCanvas').getContext('2d');
    
    var img_reka = new Image();
    var img_kipat_barzel = new Image();
    var img_kb_rocket = new Image();   
    var img_rocket = new Image();
    var audio_boom = new Audio('boom.mp3');  
    var audio_succes = new Audio('succes.mp3');     

    var interceptor_x = 700; interceptor_y = 570;
    var missiles = new Array({x: interceptor_x + 15, y: interceptor_y}, {x: interceptor_x + 15, y: interceptor_y},
                             {x: interceptor_x + 15, y: interceptor_y}, {x: interceptor_x + 15, y: interceptor_y})
    var rockets = new Array({x: 0, y: 500})

    var money = 1000; add_rocket = 0; level = 0;
    // var pause = true; t = 0;
   
    set_interval = setInterval(Rocket_Aviation, 10);
    document.onkeydown = Man_Moves;
    
</script>